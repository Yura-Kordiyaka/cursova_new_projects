{% extends 'backend/base.html' %}

{% block url_patern %}
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCA48fxJ82oBUqhCYIYd2RG4-uHXh7jyRM&loading=async"></script>
    <link rel="stylesheet" href="/static/main/desired_purchase.css">
{% endblock %}

{% block content %}
    <div class="form-wrapper">
        <form>
            <label for="sort">Сортування:</label>
            <select name="sort" id="sort">
                <option value="cheap_first" {% if sort_param == 'cheap_first' %}selected{% endif %}>Спочатку дешеві
                </option>
                <option value="expensive_firs" {% if sort_param == 'expensive_firs' %}selected{% endif %}>Спочатку
                    дорогі
                </option>
            </select>
            <button type="submit">Додати</button>
        </form>
        <button class="add-button-desired-purchase" id="add-button-desired-purchase">Додати бажану покупку</button>
    </div>
    <div class="add-desired-purchase">
        <form action="{% url "add_purchase" %}" method="post">
            {% csrf_token %}
            <input type="hidden" name="add_desired_purchase">
            <label for="name_of_product">
                Назва покупки
            </label>
            <input type="text"
                   id="name_of_product"
                   name="name_of_product"
                   minlength="3"
                   placeholder="введіть назву продукту" required/>
            <div class="wrap">
                <button type="submit">
                    Submit
                </button>
            </div>
        </form>
    </div>
    <div class="main-wrapper">
        {% for purchase  in desired_purchase %}
            <p>Назва: {{ purchase.name_of_product }}</p>
            <a class="delete-desired-purchase" href="{% url 'delete_desired_purchase' pk=purchase.id %}">Видалити
                товар</a>
            <a class="search-in-shop" href="{% url 'search_in_shop' name_of_product=purchase.name_of_product %}">Знайти
                у магазинах</a>
            <hr>
        {% endfor %}
    </div>
    <div>
        {% if desired_purchase.has_previous %}
            <a class="pagination__link"
               href="{% if sort_param %}{{ request.get_full_path }}&page=

               
                   
                   {{ desired_purchase.previous_page_number }}{% else %}?page={{ desired_purchase.previous_page_number }}{% endif %}">
                Попередня
            </a>
        {% endif %}
        Сторінка {{ desired_purchase.number }} з {{ desired_purchase.paginator.num_pages }}
        {% if categories.has_next %}
            <a class="pagination__link"
               href="{% if sort_param %}{{ request.get_full_path }}&page=

               
                   
                   {{ desired_purchase.next_page_number }}{% else %}?page={{ desired_purchase.next_page_number }}{% endif %}">
                Наступна
            </a>
        {% endif %}
    </div>
    <div id="map_canvas" style="width:700px; height:500px;"></div>
    <script>
        let buttonAddPurchase = document.getElementById('add-button-desired-purchase');
        buttonAddPurchase.addEventListener('click', function () {
            if (buttonAddPurchase.classList.contains('add-button-desired-purchase')) {
                document.querySelector('.add-desired-purchase').style.display = 'block';
                buttonAddPurchase.innerText = 'Скасувати додавання';
                buttonAddPurchase.classList.remove('add-button-desired-purchase');
                buttonAddPurchase.classList.add('stop-adding-purchase');
            } else {
                document.querySelector('.add-desired-purchase').style.display = 'none';
                buttonAddPurchase.innerText = 'Додати бажану покупку';
                buttonAddPurchase.classList.add('add-button-desired-purchase');
                buttonAddPurchase.classList.remove('stop-adding-purchase');
            }


        });
      
    </script>
{% endblock %}